{% extends 'base.html' %} {% block title %} Crop {% endblock title %} {% block body %}

<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <style>
        .hero-image {
            background-image: linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.1)), url("/static/images/4.jpeg");
            height: 50%;
            background-position: center;
            background-repeat: no-repeat;
            background-size: cover;
            position: relative;
        }
        
        .backgr-image {
            background-image: linear-gradient(rgba(0, 0, 0.1, 0.1), rgba(0, 0, 0.1, 0.1)), url("/static/images/1.jpeg");
            height: 100%;
            background-position: center;
            background-repeat: no-repeat;
            background-size: cover;
            position: relative;
            margin-top: 10px;
            margin-bottom: 10px;
            color: white;
        }
        
        .hero-text {
            text-align: center;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
        }
        
        .text-colors {
            color: #7dcaf3;
        }
        
        .btn-info {
            background-color: #7dcaf3;
            border-color: #fff;
        }
        
        #myBtn {
            display: none;
            position: fixed;
            bottom: 20px;
            right: 100px;
            z-index: 999;
            font-size: 10px;
            border: none;
            outline: none;
            background-color: #7dcaf3;
            color: white;
            cursor: pointer;
            padding: 10px;
            border-radius: 50%;
        }
        
        .aboutimg {
            width: 100%;
            height: 500px !important;
        }
    </style>
</head>

<body>
    <!-- Hero Section -->
    <div class="hero-image">
        <div class="hero-text">
            <p class="breadcrumbs text-white font-weight-bold">
                <span class="mr-2"><a href="{{ url_for('hello_world') }}" class="text-white">Home /</a></span>
                <span>Crop Recommendation</span>
            </p>
            <h1 class="mb-0 bread font-weight-bold">Find the most suitable crop for your farm</h1>
        </div>
    </div>

    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
            <div class="navbar-nav mx-auto">
                <a class="nav-item nav-link active" href="{{ url_for('dashboard') }}">Dashboard</a>
                <a class="nav-item nav-link" href="{{ url_for('crop_recommend') }}">Crop</a>
                <a class="nav-item nav-link" href="{{ url_for('fertilizer_recommendation') }}">Fertilizer</a>
                <a class="nav-item nav-link" href="{{ url_for('disease_prediction') }}">Disease</a>
                <a class="nav-item nav-link" href="{{ url_for('logout') }}">Logout</a>
            </div>
        </div>
    </nav>

    <!-- Form -->
    <div class="container backgr-image">
        <form method="POST" action="{{ url_for('crop_prediction') }}">
            <!-- State & City -->
            <div class="form-group">
                <label><b>State</b></label>
                <select id="sts" name="stt" class="form-control" onchange="print_city('state', this.selectedIndex);" required></select>
                <br/>
                <label><b>City</b></label>
                <select id="state" name="city" class="form-control" required></select>
            </div>

            <!-- NPK, pH, Rainfall -->
            <div class="form-group">
                <label>Nitrogen (N)</label>
                <input type="number" class="form-control" id="nitrogen" name="nitrogen" placeholder="Enter value or click autofill">
            </div>
            <div class="form-group">
                <label>Phosphorous (P)</label>
                <input type="number" class="form-control" id="phosphorous" name="phosphorous" placeholder="Enter value or click autofill">
            </div>
            <div class="form-group">
                <label>Potassium (K)</label>
                <input type="number" class="form-control" id="pottasium" name="pottasium" placeholder="Enter value or click autofill">
            </div>
            <div class="form-group">
                <label>pH</label>
                <input type="number" step="0.1" class="form-control" id="ph" name="ph" placeholder="Enter value or click autofill">
            </div>
            <div class="form-group">
                <label>Rainfall</label>
                <input type="number" step="0.1" class="form-control" id="rainfall" name="rainfall" placeholder="Enter value or click autofill">
            </div>

            <!-- Auto-fill button -->
            <div class="text-center mb-3">
                <button type="button" class="btn btn-info" onclick="autoFillValues()">Auto-fill Values</button>
            </div>

            <!-- Submit -->
            <div class="text-center">
                <button type="submit" class="btn btn-success btn-lg bg-transparent">Predict</button>
            </div>
        </form>
    </div>

    <!-- Footer -->
    <footer class="page-footer font-small blue pt-5">
        <div class="footer-copyright text-center py-3 bg-dark text-light p-2">
            <h5>Â© 2021 Precision Agriculture Using ML & IoT
                <div class="text-uppercase font-weight-bold text-white">Go Green....</div>
            </h5>
        </div>
    </footer>

    <!-- JS -->
    <script>
        // Populate state & city dropdown
        print_state("sts");

        function autoFillValues() {
            const state = document.getElementById('sts').value;
            const city = document.getElementById('state').value;

            if (!state || !city) {
                alert("Please select state and city first!");
                return;
            }

            fetch('/get_soil_data', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ state, city })
            })
            .then(res => res.json())
            .then(data => {
                if (data.error) {
                    alert(data.error);
                    return;
                }
                document.getElementById('nitrogen').value = data.N;
                document.getElementById('phosphorous').value = data.P;
                document.getElementById('pottasium').value = data.K;
                document.getElementById('ph').value = data.pH;
                document.getElementById('rainfall').value = data.rainfall;
            })
            .catch(err => console.error(err));
        }
    </script>

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
</body>
</html>

{% endblock body %}
